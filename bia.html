<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Brothers in Arms</title>
  <meta name="description" content="Brothers in Arms event hub: banner, countdown, anthem link, and news updates." />
  <style>
    :root{--bg:#0b1020;--panel:#0f1724;--ink:#ffffff;--muted:#9aa4b2;--a:#8b5cf6;--b:#06b6d4}
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#08111f);
      color:var(--ink);
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif
    }

    /* Content wrapper */
    .wrap{max-width:1040px;margin:0 auto;padding:20px}
    @media (max-width:480px){ .wrap{padding:16px} }

    /* Hero banner */
    .bia-hero{width:100%;min-height:300px;display:grid;place-items:center;position:relative;overflow:hidden}
    .bia-hero::before{
      content:"";position:absolute;inset:0;
      background:#0b1020 url('assets/bia_banner_final_1920x500.png') center/cover no-repeat;
      filter:contrast(1.05) saturate(1.02);z-index:0
    }
    .bia-hero::after{
      content:"";position:absolute;inset:0;
      background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.55));z-index:0
    }
    .bia-hero-inner{position:relative;z-index:1;text-align:center;padding:72px 20px 56px}
    .bia-title{font-size:48px;margin:0 0 8px;letter-spacing:.3px;color:#fff;text-shadow:0 3px 12px rgba(0,0,0,.55)}
    .bia-tag{color:#dbeafe;font-weight:600}

    /* Panels */
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.04));
      border:1px solid rgba(255,255,255,0.08);
      border-radius:14px;padding:18px;margin-top:18px
    }

    /* Countdown */
    .clock{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
    .count{font-size:44px;font-weight:800}
    .status{
      padding:6px 10px;border-radius:999px;
      background:rgba(139,92,246,.18);
      border:1px solid rgba(139,92,246,.35);
      font-weight:700
    }
    .meta{color:var(--muted);font-size:13px}

    /* Music */
    .songs{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    .song-link{
      display:inline-flex;align-items:center;gap:10px;font-weight:800;
      background:linear-gradient(90deg,var(--a),var(--b));
      color:#021124;padding:10px 14px;border-radius:10px;text-decoration:none
    }
    .song-note{font-size:12px;color:var(--muted)}
    @media(max-width:860px){.songs{grid-template-columns:1fr}}

    /* News cards */
    .news-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
    .news-card{border:1px solid rgba(255,255,255,.08);border-radius:12px;overflow:hidden;background:rgba(255,255,255,.02)}
    .news-thumb{
      max-height:180px;     /* cap the height so it doesn’t take over */
      width:auto;           /* keep true 3:2 ratio */
      max-width:100%;       /* don’t overflow */
      object-fit:contain;   /* show full image */
      background:#000;      /* subtle letterbox if needed */
      display:block;
      margin:0 auto;
      border-bottom:1px solid rgba(255,255,255,.08)
    }
    .news-body{padding:12px}
    .news-title{margin:0 0 6px;font-size:16px;font-weight:800;color:#fff}
    .news-date{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <!-- Shared floating nav -->
  <div id="nav-placeholder"></div>
  <script>
    fetch('nav.html').then(r=>r.text()).then(h=>{ document.getElementById('nav-placeholder').innerHTML=h; });
  </script>

  <!-- Hero -->
  <section class="bia-hero" aria-label="Brothers in Arms banner">
    <div class="bia-hero-inner">
      <h1 class="bia-title">BROTHERS IN ARMS</h1>
      <div class="bia-tag">Shields first, tears later.</div>
    </div>
  </section>

  <main class="wrap" role="main">
    <!-- Countdown / Status -->
    <section class="card" aria-labelledby="clock-h">
      <h2 id="clock-h">Countdown</h2>
      <div class="clock">
        <div>
          <div id="event-status" class="status">Calculating…</div>
          <div id="count" class="count">--:--:--</div>
          <div id="when-local" class="meta"></div>
          <div id="when-utc" class="meta"></div>
        </div>
        <div style="flex:1;min-width:260px">
          <p class="meta"><strong>Window:</strong> Starts <span id="startPretty">—</span> • Ends <span id="endPretty">—</span></p>
          <p class="meta">Repeats every 28 days on the same UTC cycle.</p>
        </div>
      </div>
    </section>

    <!-- Music / Anthem -->
    <section class="card" aria-labelledby="music-h">
      <h2 id="music-h">Anthem & Songs</h2>
      <div class="songs">
        <div>
          <a class="song-link" href="https://suno.com/s/F7DKbcbeRxnpaiI0" target="_blank" rel="noopener">▶ Play: Brothers in Arms (Suno)</a>
          <div class="song-note">Video next time — we’ll embed YouTube/Spotify when available.</div>
        </div>
        <div>
          <ul style="margin:0;padding-left:18px">
            <li><strong>Flag at Dawn (edit)</strong> — placeholder</li>
            <li><strong>Shield-Shame Mix</strong> — placeholder</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- News / Battle Updates -->
    <section class="card" aria-labelledby="news-h">
      <h2 id="news-h">News & Battle Updates</h2>
      <div id="news" class="news-grid"></div>
    </section>
  </main>

  <!-- Shared footer -->
  <div id="footer-placeholder"></div>
  <script>
    fetch('footer.html').then(r=>r.text()).then(h=>{ document.getElementById('footer-placeholder').innerHTML=h; });
  </script>

  <script>

  // =============================
// Brothers in Arms timing logic
// =============================
const ANCHOR_START_UTC = Date.parse('2025-09-26T00:00:00Z');
// 2 days (48h) in ms:
const WINDOW_MS = 2 * 24 * 60 * 60 * 1000; 
const PERIOD_MS = 28 * 24 * 60 * 60 * 1000;


    function getCurrentWindow(now = Date.now()){
      const n = Math.floor((now - ANCHOR_START_UTC)/PERIOD_MS);
      const prevStart = ANCHOR_START_UTC + Math.max(n,0)*PERIOD_MS;
      const prevEnd   = prevStart + WINDOW_MS;
      if (now < prevStart) return { start: prevStart, end: prevEnd, state: 'before' };
      if (now >= prevStart && now <= prevEnd) return { start: prevStart, end: prevEnd, state: 'live' };
      const nextStart = prevStart + PERIOD_MS;
      const nextEnd   = nextStart + WINDOW_MS;
      return { start: nextStart, end: nextEnd, state: 'after' };
    }

    function fmtLocal(ts){ return new Date(ts).toLocaleString(); }
    function fmtUTC(ts){ return new Date(ts).toISOString().replace('T',' ').replace(':00.000Z',' UTC'); }

    const $count = document.getElementById('count');
    const $status= document.getElementById('event-status');
    const $whenL = document.getElementById('when-local');
    const $whenU = document.getElementById('when-utc');
    const $sp = document.getElementById('startPretty');
    const $ep = document.getElementById('endPretty');

    function tick(){
      const now = Date.now();
      const w = getCurrentWindow(now);
      $sp.textContent = fmtLocal(w.start);
      $ep.textContent = fmtLocal(w.end);
      $whenL.textContent = `Local: ${fmtLocal(w.start)} → ${fmtLocal(w.end)}`;
      $whenU.textContent = `UTC: ${fmtUTC(w.start)} → ${fmtUTC(w.end)}`;

      let target, label;
      if (w.state === 'live') { label = 'Event Live — time remaining'; target = w.end; }
      else if (w.state === 'before') { label = 'Countdown to Clash'; target = w.start; }
      else { label = 'Event Ended — next in 28 days'; target = w.start; }
      $status.textContent = label;

      const diff = Math.max(0, target - now);
      const h = Math.floor(diff/3600000);
      const m = Math.floor((diff%3600000)/60000);
      const s = Math.floor((diff%60000)/1000);
      $count.textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }
    tick(); setInterval(tick, 1000);

    // =============================
    // News cards
    // =============================
    const news = [
      {
        date: new Date(Date.now() - 86400000).toISOString().slice(0,10),
        title: 'NUT RULES UNCHANGED — BIA CONTINUES',
        img: 'assets/bia/council.png',
        blurb: "Council couldn't get unanimous vote to change rules!"
      },
      {
        date: new Date().toISOString().slice(0,10),
        title: 'ETF RUNS AT FIRST SCOUT',
        img: 'assets/bia/bia-etf1.png',
        blurb: 'ETF player whose name starts with P teleported the second Whaleslaughter scouted them.'
      }
    ];

    function renderNews(){
      const c = document.getElementById('news');
      c.innerHTML = news.map(n => `
        <article class="news-card">
          <img class="news-thumb" loading="lazy" alt="update image" src="${n.img}">
          <div class="news-body">
            <h3 class="news-title">${n.title}</h3>
            <div class="news-date">${n.date}</div>
            <p style="margin:8px 0 0 0">${n.blurb}</p>
          </div>
        </article>`).join('');
    }
    renderNews();
  </script>
</body>
</html>
